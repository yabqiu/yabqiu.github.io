---
title: Quartz Job Scheduling Framework［翻译］第五章. Cron 触发器及相关内容 (第四部分)
url: /quartz-job-scheduling-framework-5-4/
date: 2008-04-03T23:07:00-05:00
featured: false
draft: false
type: post
toc: false
# menu: main
usePageBundles: true
thumbnail: "../images/logos/quartz-logo.jpeg"
categories:
  - Quartz
tags: 
  - Quartz
  - 翻译
comment: true
codeMaxLines: 50
# additional
wpPostId: 422 
wpStatus: publish
views: 665
lastmod: 2019-12-11T18:56:19-06:00
---

<strong>七. Cron 表达式 Cookbook</strong></p>
<br/>
此处的 Cron 表达式 cookbook 旨在为常用的执行需求提供方案。尽管不可能列举出所有的表达式，但下面的应该为满足你的业务需求提供了足够的例子。<br/><br/>
<strong>·分钟的 Cron 表达式</strong><br/><br/>
<table width="600" cellspacing="5">
<caption><strong>表 5.1. 包括了分钟频度的任务计划 Cron 表达式</strong></caption>
<tbody>
<tr>
<td><strong>用法</strong></td>
<td width="150"><strong>表达式</strong></td>
</tr>
<tr>
<td>每天的从 5:00 PM 至 5:59 PM 中的每分钟触发</td>
<td><span style="color: #800080;">0 * 17 * * ?</span></td>
</tr>
<tr>
<td>每天的从 11:00 PM 至 11:55 PM 中的每五分钟触发</td>
<td><span style="color: #800080;">0 0/5 23 * * ?<br />
</span></td>
</tr>
<tr>
<td>每天的从 3:00 至 3:55 PM 和 6:00 PM 至 6:55 PM 之中的每五分钟触发</td>
<td><span style="color: #800080;">0 0/5 15,18 * * ?<br />
</span></td>
</tr>
<tr>
<td>每天的从 5:00 AM 至 5:05 AM 中的每分钟触发</td>
<td><span style="color: #800080;">0 0-5 5 * * ?</span></td>
</tr>
</tbody>
</table>
<br/>
<!--more-->
<strong>·日上的 Cron 表达式</strong><br/>
<table width="600" cellspacing="5">
<caption><strong><br />
表 5.2. 基于日的频度上任务计划的 Cron 表达式</strong></caption>
<tbody>
<tr>
<td><strong>用法</strong></td>
<td width="150"><strong>表达式</strong></td>
</tr>
<tr>
<td>每天的 3:00 AM </td>
<td><span style="color: #800080;">0 0 3 * * ?</span></td>
</tr>
<tr>
<td>每天的 3:00 AM (另一种写法) </td>
<td><span style="color: #800080;">0 0 3 ? * *</span></td>
</tr>
<tr>
<td>每天的 12:00 PM (中午)</td>
<td><span style="color: #800080;">0 0 12 * * ?</span></td>
</tr>
<tr>
<td>在 2005 中每天的 10:15 AM</td>
<td><span style="color: #800080;">0 15 10 * * ? 2005</span></td>
</tr>
</tbody>
</table>
<br/>
<strong>·周和月的 Cron 表达式</strong><br/><br/>
<table width="600" cellspacing="5">
<caption><strong>表 5.3. 基于周和/或月的频度上任务计划的 Cron 表达式</strong></caption>
<tbody>
<tr>
<td><strong>用法</strong></td>
<td width="150"><strong>表达式</strong></td>
</tr>
<tr>
<td>在每个周一,二, 三和周四的 10:15 AM</td>
<td><span style="color: #800080;">0 15 10 ? * MON-FRI</span></td>
</tr>
<tr>
<td>每月15号的 10:15 AM  </td>
<td><span style="color: #800080;">0 15 10 15 * ?</span></td>
</tr>
<tr>
<td>每月最后一天的 10:15 AM</td>
<td><span style="color: #800080;">0 15 10 L * ?</span></td>
</tr>
<tr>
<td>每月最后一个周五的 10:15 AM </td>
<td><span style="color: #800080;">0 15 10 ? * 6L</span></td>
</tr>
<tr>
<td>在 2002, 2003, 2004, 和 2005 年中的每月最后一个周五的 10:15 AM </td>
<td><span style="color: #800080;">0 15 10 ? * 6L 2002-2005</span></td>
</tr>
<tr>
<td>每月第三个周五的 10:15 AM</td>
<td><span style="color: #800080;">0 15 10 ? * 6#3</span></td>
</tr>
<tr>
<td>每月从第一天算起每五天的 12:00 PM (中午)</td>
<td><span style="color: #800080;">0 0 12 1/5 * ?</span></td>
</tr>
<tr>
<td>每一个 11 月 11 号的 11:11 AM</td>
<td><span style="color: #800080;">0 11 11 11 11 ?</span></td>
</tr>
<tr>
<td>三月份每个周三的 2:10 PM 和 2:44 PM</td>
<td><span style="color: #800080;">0 10,44 14 ? 3 WED</span></td>
</tr>
</tbody>
</table>
<br/>
<strong>八. 创建一个即刻触发的 Trigger</strong><br/><br/>
有时候，你需要立即执行一个 job。例如，想像一下，你正在构建一个 GUI 程序并允许用户能立刻执行。另一个例子，你或许已经检测到了某个 Job 未执行成功，因此你想要即刻重跑一次。在 Quartz 1.5，有几个方法被加入到了 <span style="color: #800080;">TriggerUtils</span> 类中，使得实现那些事很容易了。代码 5.4 展示了如何部署一个 job，只让它立即执行一次。<br/><br/>
<strong>代码 5.4. 你可以用 <span style="color: #800080;">TriggerUtils</span> 来立即执行一个 Job</strong><br/>
{{< highlight java >}}
public class Listing_5_4 {
     static Log logger = LogFactory.getLog(Listing_5_4.class);

    public static void main(String[] args) {
         Listing_5_4 example = new Listing_5_4();
         example.runScheduler();
    }

    public void runScheduler() {
         Scheduler scheduler = null;

         try {
              // Create a default instance of the Scheduler
              scheduler = StdSchedulerFactory.getDefaultScheduler();
              scheduler.start();
              logger.info("Scheduler was started at " + new Date());

              // Create the JobDetail
              JobDetail jobDetail = new JobDetail("PrintInfoJob",
                                           Scheduler.DEFAULT_GROUP,
                                           PrintInfoJob.class);

              // Create a trigger that fires once right away
              Trigger trigger = TriggerUtils.makeImmediateTrigger(0, 0);

              trigger.setName("FireOnceNowTrigger");

              scheduler.scheduleJob(jobDetail, trigger);
         } catch (SchedulerException ex) {
             logger.error(ex);
         }
    }
}
{{</ highlight >}}
<br/>
在代码 5.4 中，<span style="color: #800080;">TriggerUtils</span> 的 <span style="color: #800080;">makeImmediateTrigger()</span> 方法被用来立即执行一个 Job。第一个参数是将要触发的次数。第二个参数是执行的间隔时间。为方便起见，这个方法的签名显示如下：<br/><br/>
<span style="color: #800080;">public static Trigger  makeImmediateTrigger(int repeatCount, long repeatInterval);</span><br/><br/>
<span style="color: #800080;">TriggerUtils</span> 类提供了许多便利的方法简化了 Trigger 的使用。确切地检查一下这个工具类中看看是否有你想要的东西。你还将在本书上看到更多的使用 <span style="color: #800080;">TriggerUtils</span> 的例子。
