---
title: "ORACLE 常用脚本（3）[转]"
url: /oracle-scripts-3/
date: 2006-09-19T00:04:00-05:00
featured: false
draft: true
type: post
toc: false
# menu: main
usePageBundles: true
categories:
  - Database
tags: 
  - Oracle
comment: true
codeMaxLines: 50
# additional
wpPostId: 546 
wpStatus: publish
views: 316
lastmod: 2014-01-28T00:52:05-06:00
---

<strong><br/>
<span style="font-size: medium;">用户的管理</span><br/>
</strong><br/>
<br/>
<strong>一、ORACLE的安全域<br/>
</strong><br/>
<br/>
1、TABLESPACE QUOTAS：表空间的使用定额<br/>
2、DEFAULT TABLESPACE：默认表空间<br/>
3、TEMPORARY TABLESPACE：指定临时表空间。<br/>
4、ACCOUNT LOCKING：用户锁<br/>
5、RESOURCE LIMITE：资源限制<br/>
6、DIRECT PRIVILEGES：直接授权<!--more--><br/>
7、ROLE PRIVILEGES：角色授权先将应用中的用户划为不同的角色，<br/>
<br/>
<strong>二、创建用户时的清单：<br/>
</strong><br/>
1、选择一个用户名称和检验机制：A，看到用户名，实际操作者是谁，业务中角色。<br/>
2、选择合适的表空间：<br/>
3、决定定额：<br/>
4、口令的选择：<br/>
5、临时表空间的选择：先建立一个临时表空间，然后在分配。不分配，使用SYSTEM表空间<br/>
6、CREATE USER<br/>
7、授权：A，用户的工作职能<br/>
      B，用户的级别<br/>
<br/>
<strong>三、用户的创建：<br/>
</strong><br/>
1、命令：<br/>
CREATE USER 名称 IDENTIFIED BY 口令 DEFAULT TABLESPACE 默认表空间名 TEMPOARAY<br/>
TABLESPACE 临时表空间名<br/>
QUOTA 15M ON 表空间名<br/>
[PASSWORD EXPIRE]：当用户第一次登陆到ORACLE，创建时所指定的口令过期失效，强迫用户自己定义一个新口令。<br/>
[ACCOUNT LOCK]：加用户锁<br/>
QUOTA UNLIMITED ON TABLESPACE：不限制，有多少有多少。<br/>
[PROFILE 名称]：受PROFILE文件的限制。<br/>
<br/>
<strong>四、如何控制用户口令和用户锁</strong>1、强迫用户修改口令：ALTER USER 名称 IDENTIFIED BY 新口令 PASSWORD EXPIRE；<br/>
2、给用户加锁：ALTER USER 名称 ACCOUNT [LOCK|UNLOCK]<br/>
3、注意事项：<br/>
A、所有操作对当前连接无效<br/>
B、1的操作适用于当用户忘记口令时。<br/>
<br/>
<strong>五、更改定额</strong>1、命令：ALTER USER 名称 QUOTA 0 ON 表空间名<br/>
ALTER USER 名字 QUOTA （数值）K|M|UNLIMITED ON 表空间名；<br/>
2、使用方法：<br/>
A、控制用户数据增长<br/>
B、当用户拥有一定的数据，而管理员不想让他在增加新的数据的时候。<br/>
C、当将用户定额设为零的时候，用户不能创建新的数据，但原有数据仍可访问。<br/>
<br/>
<strong>六、DROP一个USER</strong>1、DROP USER 名称<br/>
  适合于删除一个新的用户<br/>
2、DROP USER 名称 CASCADE： 删除一个用户，将用户的表，索引等都删除。<br/>
3、对连接中的用户不好用。<br/>
<br/>
<strong>七、信息获取：<br/>
</strong><br/>
1、DBA_USERS:用户名，状态，加锁日期，默认表空间，临时表空间<br/>
2、DBA_TS_QUOTAS:用户名，表空间名，定额。<br/>
两个表的连接字段：USERNAME<br/>
GRANT CREATE SESSION TO 用户名<br/>
<br/>
<span style="font-size: medium;"><strong>PROFILE的管理（资源 文件）</strong></span><br/>
<br/>
<strong>一、PROFILE的管理内容：</strong><br/>
<br/>
1、CPU的时间<br/>
2、I/O的使用<br/>
3、IDLE TIME（空闲时间）<br/>
4、CONNECT TIME（连接时间）<br/>
5、并发会话数量<br/>
6、口令机制：<br/>
<br/>
<strong>二、DEFAULT PROFILE：</strong>1、所有的用户创建时都会被指定这个PROFILE<br/>
2、DEFAULT PROFILE的内容为空，无限制<br/>
<br/>
<strong>三、PROFILE的划分：<br/>
</strong><br/>
1、CALL级LIMITE：<br/>
  对象是语句：<br/>
  当该语句资源使用溢出时：<br/>
  A、该语句终止<br/>
  B、事物回退<br/>
  C、SESSION连接保持<br/>
2、SESSION级LIMITE：<br/>
  对象是：整个会话过程<br/>
  溢出时：连接终止<br/>
<br/>
<strong>四、如何管理一个PROFILE</strong>1、CREATE PROFILE<br/>
2、分配给一个用户<br/>
3、象开关一样打开限制。<br/>
<br/>
<strong>五、如何创建一个PROFILE：<br/>
</strong><br/>
1、命令：CREATE PROFILE 名称<br/>
  LIMIT<br/>
  SESSION_PER_USER 2<br/>
  CPU_PER_SESSION 1000<br/>
  IDLE_TIME 60<br/>
  CONNECT_TIME 480<br/>
<br/>
<strong>六、限制参数：<br/>
</strong><br/>
1、SESSION级LIMITE：<br/>
  CPU_PER_SESSION:定义了每个SESSION占用的CPU的时间：   （1/100 秒）<br/>
2、SESSION_PER_USER:每个用户的并发连接数<br/>
3、CONNECT_TIME:一个连接的最长连接时间（分钟）<br/>
4、LOGICAL_READS_PER_SESSION: 一次读写的逻辑块的数量<br/>
5、CALL级LIMITE<br/>
  CPU_PER_CALL:每个语句占用的CPU时间<br/>
 <br/>
  LOGICAL_READS_PER_CALL:<br/>
<br/>
<strong>七、分配给一个用户：<br/>
</strong><br/>
CREATE USER 名称。。。。。。<br/>
PROFILE 名称<br/>
ALTER USER 名称 PROFILE 名称<br/>
<br/>
<strong>八、打开资源限制：<br/>
</strong><br/>
1、RESOURCE_LIMT:资源文件中含有<br/>
2、ALTER SYSTEM SET RESOURCE_LIMIT=TRUE；<br/>
3、默认不打开<br/>
<br/>
<strong>九、修改PROFIE的内容：<br/>
</strong><br/>
1、ALTER PROFILE 名称参数   新值<br/>
2、对于当前连接修改不生效。<br/>
<br/>
DROP一个PROFILE<br/>
1、DROP PROFILE 名称<br/>
  删除一个新的尚未分配给用户的PROFILE，<br/>
2、DROP PROFILE 名称 CASCADE<br/>
3、注意事项<br/>
  A、一旦PROFILE被删除，用户被自动加载DEFAULT PROFILE<br/>
  B、对于当前连接无影响<br/>
  C、DEFAULT PROFILE不可以被删除<br/>
<br/>
<strong>信息获取：<br/>
</strong><br/>
1、DBA_USERS:<br/>
  用户名，PROFILE<br/>
2、DBA_PROFILES:<br/>
  PROFILE及各种限制参数的值<br/>
每个用户的限制：PROFILE（关键字段）<br/>
<br/>
PROFILE的口令机制限制<br/>
1、限制内容<br/>
A、限制连续多少次登录失败，用户被加锁<br/>
B、限制口令的生命周期<br/>
C、限制口令的使用间隔<br/>
2、限制生效的前提：<br/>
A、RESOURCE_LIMIT:=TRUE<br/>
B ORACLE\RDBMS\ADMIN\UTLPWDMG.SQL<br/>
3、如何创建口令机制：<br/>
CREATE PROFILE 名称<br/>
SESSIONS_PER_USER<br/>
.....<br/>
password_life_time 30<br/>
failed_log_attempts 3<br/>
password_reuse_time 3<br/>
4、参数的含义：<br/>
A FAILED_LOGIN_ATTEMPTS:<br/>
  当连续登陆失败次数达到该参数指定值时，用户加锁<br/>
B PASSWORD_LOCK_TIME:加锁天数<br/>
C PASSWORD_LIFE_TIME:口令的有效期（天）<br/>
D PASSWORD_GRACE_TIME:口令修改的间隔期（天）<br/>
E PASSWORD_REUSE_TIME:口令被修改后原有口令隔多少天被重新使用。<br/>
F PASSWORD_REUSE_MAX:口令被修改后原有口令被修改多少次被重新使用。
