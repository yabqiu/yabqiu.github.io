---
title: Burst 的 VPS (Ubuntu) 上安装 xfce 和 vnc
url: /vnc-burst-vps-ubuntu-xfce/
date: 2011-04-21T12:39:59-05:00
featured: false
draft: false
type: post
toc: false
# menu: main
usePageBundles: true
categories:
  - Linux/Unix
tags: 
  - Ubuntu
  - vps
  - burst
  - xfce
  - vnc
comment: true
codeMaxLines: 50
# additional
wpPostId: 3477 
wpStatus: publish
views: 2268
lastmod: 2013-12-31T02:21:39-06:00
---

相信你也是个 Linux 的能手才会去购买一个 Linux VPS 系统，多数时间用 ssh 就足够了，但也有人免不了希望在图形界面下看些东西，那么为你的 VPS 安装个 VNC 就很有必要性了。本人已在 Burst 弄来的 512 M 内存的 Ubuntu 10.04 LTS VPS 实际操作怎么安装 VNC 远程使用它的图形界面，安装的方法可能也有好多种，不过这里是我成功例子的操作步骤，如下：<br/>
<br/>
1. 安装显示系统 x11，命令：<br/>
<br/>
    root@217352:~#<span style="color: #800000;">apt-get install xorg</span><br/>
<br/>
这一步要安装包的大小大约是 20 来 M，如果是美国的服务器，可以眼争争的看着它完成，很快的。完了我们就有了 X11 了。<!--more--><br/>
<br/>
2. 安装桌面支持，Linux 著名的桌面系统有 gnome 和 KDE，还有轻量级的 xfce4，由于实际网络及系统的条件，我这里选择安装 xfce4，命令：<br/>
<br/>
    root@217352:~#<span style="color: #800000;">apt-get install xfce4</span><br/>
<br/>
这一步安装包大小 200 来 M，对于每秒 10 几 M 的下载速度可能还不够你上个小 WC，安装之前你会看到一堆东西要安装，都要安装了。<br/>
<br/>
3. 现在可以安装 vnc 服务端，命令：<br/>
<br/>
    root@217352:~#<span style="color: #800000;">apt-get install vnc4server</span><br/>
<br/>
4. 现在你可以执行 vnc 服务端了，可以直接执行<br/>
<br/>
   root@217352:~# <span style="color: #800000;">vncserver</span><br/>
<br/>
现在还用不着急着去用 -geometry 1024X768 -depth 16 去指定显示分辨率和颜色深度。执行 vncserver 后正常的话会提示你输入两篇连接密码，成功的话能够看到类似的信息：<br/>
<br/>
New '217352:1 (root)' desktop is 217352:1<br/>
<br/>
Starting applications specified in /root/.vnc/xstartup<br/>
Log file is /root/.vnc/217352:1.log<br/>
<br/>
5. 客户端连接，vnc 客户端很多种，我也是建议你用 TightVNC, 从 <a href="http://www.tightvnc.com/download.html">http://www.tightvnc.com/download.html</a> 下载，您只需要在你的本地电脑上安装 vncview 组件。<br/>
<p style="text-align: left;">打开 vncview，输入服务器的 ip地址:1，然后连接，按照提示输入刚刚设置的密码就可登陆。</p>

<p style="text-align: left;"><img class="aligncenter" src="/wp-content/uploads/2011/04/vnc-client-login.png" alt="vnc-client-login" width="386" height="170" /></p>

OK，成功登陆了，可是你现在应该也只是能看到一个命令窗口，和 ssh 分别不那么大，对的，现在还是个 xterm+tvm，所以还有点工作要做.<br/>
<p style="text-align: center;"><img class="aligncenter" title="burst-vnc1" src="/wp-content/uploads/2011/04/burst-vnc1.png" alt="burst-vnc1" width="704" height="556" /></p>

6. 把原来的 vncserver 结束掉，修改下 /root/.vnc/xstartup 文件<br/>
<br/>
    root@217352:~#<span style="color: #800000;">vncserver -kill :1</span>     杀了刚刚启的 vncserver 进程<br/>
<br/>
    root@217352:~#<span style="color: #800000;">vi /root/.vnc/xstartup</span>    打开 /root/.vnc/xstartup 文件，里面的内容只需要下面两行，其他的可以注释掉：<br/>
<br/>
<span style="color: #ff6600;">        #!/bin/sh</span><br/>
<span style="color: #ff6600;">        /usr/bin/startxfce4 &amp;</span><br/>
<br/>
    保存该文件，由于 /usr/bin/startxce4 本身是可执行的，其实可不用 chmod +x 加执行权限<br/>
<br/>
7. 现在再执行 vncserver 来启动 vnc 服务<br/>
<br/>
    root@217352:~#<span style="color: #800000;">vncserver</span><br/>
<br/>
现在再次用 vncviewer 来连接服务器，看到的就是真正的 xfce 界面了，速度基本还是能接受的。<br/>
<p style="text-align: center;"><a href="http://unmi.cc/wp-content/uploads/2011/04/vnc-ubuntu-xfce.png"><img class="aligncenter" src="/wp-content/uploads/2011/04/vnc-ubuntu-xfce.png" alt="vnc-ubuntu-xfce" width="737" height="532" /></a></p>

其他一些内容，自己酌情而定了，有说要执行如下两命令：<br/>
<br/>
    apt-get install x-window-system-core      不知具体内情<br/>
    apt-get install x11vnc     好像也用不着，反正我是用 apt-get remove x11vnc 把它卸载了仍然可以用<br/>
    apt-get install xdm    或说要安装这个，用于登陆界面，应该是在服务器前本地登陆才用的<br/>
<br/>
另外在启动 vncserver 时可以加一些启动选项，执行 vncserver --help 可以看到支持的选项：<br/>
<br/>
<a href="mailto:root@217352">root@217352</a>:~# vncserver --help<br/>
VNC4 server<br/>
<br/>
Usage: vncserver [&lt;OPTIONS&gt;] [:&lt;DISPLAY#&gt;]<br/>
       vncserver -kill :&lt;DISPLAY#&gt;<br/>
<br/>
&lt;OPTIONS&gt; are Xvnc4 options, or:<br/>
<br/>
        -name &lt;DESKTOP-NAME&gt;<br/>
        -depth &lt;DEPTH&gt;<br/>
        -geometry &lt;WIDTH&gt;x&lt;HEIGHT&gt;<br/>
        -httpport number<br/>
        -basehttpport number<br/>
        -alwaysshared<br/>
        -nevershared<br/>
        -pixelformat rgb&lt;NNN&gt;<br/>
        -pixelformat bgr&lt;NNN&gt;<br/>
        &lt;Xvnc4-options&gt;...<br/>
<br/>
See vnc4server and Xvnc4 manual pages for more information.<br/>
<br/>
比如执行 vncserver  -geometry 800x600 后，客户端连接后的分辨率就是 800x600，还有颜色深浅的设置等，默认是 1024x768。也能用 -httpport 设置 http 连接端口，用于客户端直接用浏览器 Applet 进行连接，如 <a href="http://ipaddress:5901/">http://ipaddress:5901</a>。<br/>
<br/>
对于 /root/.vnc/xstartup 文件的修改，有不同的意见是，只注释掉原始文件的 #x-window-manager&amp; 行，最后加上：<br/>
<br/>
<code>    x-sesion-manager &amp; xfdesktop &amp; xfce4-panel &amp;<br/>
    xfce4-menu-plugin &amp;<br/>
    xfsettingsd &amp;<br/>
    xfconfd &amp;<br/>
    xfwm4 &amp;</code><br/>
<br/>
<code>保存它来作用到 vncserver。</code><br/>
<br/>
<code>有些地方提到的可定制启动 vncserver 的参数，CentOS 是在 /etc/sysconfig/vncservers 文件后加上：</code><br/>
<br/>
<code>VNCSERVERS="1:root"<br/>
VNCSERVERARGS[1]="-geometry 800x600"<br/>
如果想设置多个用户,可以用如下格式:<br/>
VNCSERVERS="1:one 2:two 3:three"<br/>
VNCSERVERARGS[1]="-geometry 800x600"<br/>
VNCSERVERARGS[2]="-geometry 800x600"<br/>
VNCSERVERARGS[3]="-geometry 800x600"</code><br/>
<br/>
<code>不知道 Ubuntu 的启动参数该加到哪个文件中，反正是找不到 /etc/sysconfi/vncservers 文件，会是 xstartup 文件吗？</code><br/>
<br/>
参考：1. <a href="http://www.xker.com/page/e2011/0216/100181.html" target="_blank">Ubuntu下安装wine+utorrent+VNC介绍</a><br/>
             2. <a href="http://kangxiaowei.com/2624.html" target="_blank">ubuntu(burst)安装xfce和vnc</a><br/>
             3. <a href="http://hi.baidu.com/%BF%B5%CF%FE%E7%E2/blog/item/752858e8ec9a412bb80e2d8e.html" target="_blank">ubuntu(burst)安装gnome和vnc</a><br/>
             4. <a href="http://markus.revti.com/2009/08/installing-vnc-remote-desktop-on-ubuntu-linux-vps/">http://markus.revti.com/2009/08/installing-vnc-remote-desktop-on-ubuntu-linux-vps/</a><br/>
             5. <a href="http://dkyu.com/2011/04/04/%E5%A6%82%E4%BD%95%E5%9C%A8ubuntu-server-%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85-vnc4server-%E6%9C%8D%E5%8A%A1%E5%92%8Cxfce-%E5%9B%BE%E5%BD%A2%E7%8E%AF%E5%A2%83/" target="_blank">如何在ubuntu server 环境安装 vnc4server 服务和xfce 图形环境</a>
