---
title: Objective-C 的方法原型及重载
url: /objectivec-method-prototype-overload/
date: 2011-08-21T03:44:42-05:00
featured: false
draft: true
type: post
toc: false
# menu: main
usePageBundles: true
categories:
  - iOS
tags: 
  - ios
  - objective-c
comment: true
codeMaxLines: 50
# additional
wpPostId: 3752 
wpStatus: publish
views: 1408
lastmod: 2011-09-09T03:43:07-05:00
---

毫无疑问，Objective-C&nbsp;也是一种面向对象语言，那么面向对象有三个基本特征(封装、继承、多态)。重载似乎与这三大特征没多大关系，方法覆盖才预示着多态。但重载还是与覆盖有一定的关联，它们都要求你能识别出方法的原型，这就引出方法原型与重载的关系。<br/>
<br/>
Objective-C&nbsp;与最常见的语言如，C++、C#、Java&nbsp;在这方面是不同的，我们知道，Java、C++&nbsp;和 C#&nbsp;识别方法原型是依据于方法名、参数个数、与参数类型这三要素决定，比如下面出自于一个类中的四个计算面积的方法，对于&nbsp;Java、C++&nbsp;或&nbsp;C#，它们是合法的：<br/>
<br/>
<span style="color: #800000;">float calculateArea()</span><br/>
<span style="color: #800000;">float calculateArea(int width)</span><br/>
<span style="color: #800000;">float calculateArea(float width)</span><br/>
<span style="color: #800000;">float calculateArea(int width, int height)</span><br/>
<br/>
因为它们的方法原型是不同的，分别是：<!--more--><br/>
<br/>
<span style="color: #800000;">calculateArea()</span><br/>
<span style="color: #800000;">calculateArea(int)</span><br/>
<span style="color: #800000;">calculateArea(float)</span><br/>
<span style="color: #800000;">calculateArea(int, int)</span><br/>
<br/>
然而这应用到&nbsp;Objective-C&nbsp;中就不同的，因为&nbsp;Objective-C&nbsp;还为方法的引入了一个参数描述的概念。如果你在&nbsp;Objective-C&nbsp;的某个类中相应的写下四个类似的方法：<br/>
<br/>
<span style="color: #800000;">-(float) calculateArea</span><br/>
<span style="color: #800000;">-(float) calculateArea: (int)&nbsp;width</span><br/>
<span style="color: #800000;">-(float) calculateArea: (float) width</span><br/>
<span style="color: #800000;">-(float) calculateArea: (int) width andHeight: (int) height</span><br/>
<br/>
那是不行的，这时候第二个和第三个方法会有冲突，会得到错误：<br/>
<br/>
<span style="color: #800000;">error: duplicate declaration of method '-calculateArea:'</span><br/>
<br/>
它们被认为是一样的方法，因为它们的方法原型是与参数描述有关，在&nbsp;Objective-C&nbsp;中方法的定义格式是：<br/>
<br/>
<span style="color: #800000;">-/+ (返回类型)&nbsp;方法名: (参数1类型)&nbsp;形参1&nbsp; 参数2描述: (参数2类型)&nbsp;形参2 参数3描述: (参数3类型)&nbsp;形参3 .......</span><br/>
<br/>
Objective-C&nbsp;对于每一个参数都要有一个参数描述，而第一个参数的描述由方法名本身来承载，所以有许多像<br/>
<br/>
<span style="color: #800000;">initWithFrame:</span>&nbsp;&nbsp;&nbsp; <span style="color: #800000;">stringWithString:</span>&nbsp;&nbsp;这样的方法，在方法名的后部分&nbsp;frame&nbsp;或 string&nbsp;描述了第一个参数<br/>
<br/>
基于上，Objective-C&nbsp;的方法原型是：<br/>
<br/>
<span style="color: #800000;">方法名: 参数2描述:参数3描述: .......</span><br/>
<br/>
应用于上面四个方法时，它们的原型分别是，(<span style="color: #ff0000;"><strong>注意参数描述后的冒号，一个参数对应有一个冒号</strong></span>)：<br/>
<br/>
<span style="color: #800000;">calculateArea</span><br/>
<span style="color: #800000;">calculateArea:</span><br/>
<span style="color: #800000;">calculateArea:</span><br/>
<span style="color: #800000;">calculateArea:andHeight:</span><br/>
<br/>
所以第二、三个方法就冲突了，这里还得讲一点，无参数的方法原型就是方法名，有一个参数的原型是方法名后带个冒号(:)，所以执行事件时用&nbsp;<span style="color: #800000;">SEL(onclick:)</span>&nbsp;定位 <span style="color: #800000;">IBAction</span>&nbsp;时方法名后要加个冒号，因为它后面有一个参数是 <span style="color: #800000;">(id) sender</span>。<br/>
<br/>
另一方面，采用 Objective-C&nbsp;的方法命名方式，即方法名须描述第一个参数的办法，上面的方法应重新声明如下，并纠正一个方法声明：<br/>
<br/>
<span style="color: #800000;">-(float) calculateArea</span><br/>
<span style="color: #800000;"> -(float) calculateByWidth: (int) width</span><br/>
<span style="color: #800000;">-(float) calculateByFloatWidth: (float) width</span><br/>
<span style="color: #800000;">-(float) calculateByWidth: (int) width andHeight: (int) height</span><br/>
<br/>
从 Objective-C&nbsp;对方法原型的认定，也告诉我们对方法的命名，还有每一个参数的描述更要讲究。而且它的方法调用方式(确切说是消息发送机制)&nbsp;中使用到了参数描述，也类似于有些语言(如&nbsp;VB、Groovy) 中的命名参数，使得代码更人性化，更易于理解。<br/>
<br/>
再进一步演义，在&nbsp;Objective-C&nbsp;中如果两个方法，方法名相同、参数个数一个，并且每一个参数类型也相同，它们也是可以同时存在于一个类中，如：<br/>
<br/>
<span style="color: #800000;">-(float) calculateByWidth: (int) width andXxxHeight: (int)&nbsp;xxxHeight</span><br/>
<span style="color: #800000;">-(float) calculateByWidth: (int) width andYyyHeight: (int) yyyHeight</span><br/>
<br/>
它们也是互为重载的关系，因为它们的原型分别为：<br/>
<br/>
<span style="color: #800000;">calculateByWidth:andXxxHeight:</span><br/>
<span style="color: #800000;">calculateByWidth:andYyyHeight:</span><br/>
<br/>
这在 Java、C++、C#&nbsp;等面向对象的语方中是不允许的。因此，对于 Objective-C&nbsp;来说重载的几要素就变成了&nbsp;方法名、参数个数&nbsp;和参数描述，与类型无关。最后着重强调一个，<span style="font-size: medium; color: #800000;"><strong>Objective-C&nbsp;的方法原型或重载是与参数类型无关的</strong></span>。<br/>
<br/>
<hr /><br/>
<br/>
另外，也可以不给方法指定参数描述，或者个别指定个别不指定，这时候调用方式和方法原型也有所不同了，例如：<br/>
<br/>
<span style="color: #800000;">-(void) set: (int) x :&nbsp; (int) d</span><br/>
<br/>
调用方式是：<span style="color: #800000;"> [cat set: 1 : 2]</span><br/>
原型是： <span style="color: #800000;">set::</span><br/>
<br/>
<span style="color: #800000;">-(void) set: (int) x : (int) y param3: (int) z</span><br/>
<br/>
调用方式是：<span style="color: #800000;">[cat set : 1 : 2 param3:100]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 不能用 <span style="color: #800000;">[cat set : 1 : 2 : 100] </span>来调用<br/>
原型是：<span style="color: #800000;">set::param3:</span><br/>
<br/>
参考更官方的文档，之前说的参数描述称作&nbsp;<strong><span style="color: #800000;">内部参数名(internal argument name)</span></strong>，即给方法调用时用; 而形参被叫做<strong><span style="color: #800000;">外部参数名(external argument name)</span></strong>。当指定了内部参数名时，调用时一定要用内部参数名来指定参数。<br/>
<br/>
不带参数描述的方式不推荐，会让程序不好理解，还有就是区别方法只能依据方法名与参数的个数了，方法重复定义的可能性就大了。像前面只要方法名是 set&nbsp;的任何两个参数的方法都是相同的。
