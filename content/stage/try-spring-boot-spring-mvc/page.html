---
title: 小试 Spring Boot - Spring MVC
url: /try-spring-boot-spring-mvc/
date: 2016-10-06T00:05:57-05:00
featured: false
draft: false
type: post
toc: false
# menu: main
usePageBundles: true
thumbnail: "../images/logos/http://unmi.cc/wp-content/uploads/2016/10/spring-framework-project-logo-200x200.png"
categories:
  - Spring
tags: 
  - Spring
  - Spring Boot
comment: true
codeMaxLines: 50
# additional
wpPostId: 7452 
wpStatus: publish
views: 977
lastmod: 2021-04-25T19:51:42-05:00
---

前阵想试下 Spring MVC 4 有了些什么新特性, 可真正用 Maven 在 IDE 中建立一个项目并不那么容易. Spring 当初在笑 EJB 的笨重时如今把自己也搞大了, 继而出台了一个 <a href="http://projects.spring.io/spring-boot/">Spring Boot</a> 来响应微服务的号召.</p>
<br/>
Spring Boot 的出世可以大大提升使用 Spring 框架时的开发效率. Spring 尽量简化 Spring 项目的配置, 一个 <code>mvn package</code> 就轻轻松的把一个 Web 项目打成一个  <code>fat jar</code>, 运行 <code>java -jar spring-boot-sample-1.0-SNAPSHOT.jar</code> 就能通过内嵌的 Tomcat 或 Jetty 来启动一个 Web 应用了, 更别提怎么应对普通控制台应用了.<br/><br/>
现在就来体验一下 Spring Boot 做一个 Spring MVC 项目有多简单, 我们仍然是建立一个 Maven 项目, 最简单的 <code>pom.xml</code> 文件内容如下:<!--more--><br/><br/>
<pre class="lang:default decode:true">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;<br/><br/>
    &lt;groupId&gt;cc.unmi&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-sample&lt;/artifactId&gt;
    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;<br/><br/>
    &lt;parent&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;
        &lt;version&gt;1.4.1.RELEASE&lt;/version&gt;
    &lt;/parent&gt;
    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;
&lt;/project&gt;</pre>
<br/>
上面的 <code>pom.xml</code> 配置通过 parent <code>spring-boot-starter-parent</code> 项目和对 <code>spring-boot-starter-web</code> 的依赖把相关的依赖都引入到本项目中来了.<br/><br/>
然后是一个基本实现,  <code>SampleController</code> 类<br/><br/>
<pre class="brush:java">package hello;<br/><br/>
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.EnableAutoConfiguration;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.ResponseBody;<br/><br/>
@Controller
@SpringBootApplication
public class SampleController {<br/><br/>
    @RequestMapping("/")
    @ResponseBody
    String home() {
        return "Hello World!";
    }<br/><br/>
    public static void main(String[] args) throws Exception {
        SpringApplication.run(SampleController.class, args);
    }
}
</pre>
<br/>
这里的注解 <code>@SpringBootApplication</code> 替换成 <code>@EnableAutoConfiguration</code> 也行, 但是前者更强大, 因为它是后者加上 <code>@Configuration</code> 和 <code>@ComponentScan</code> 的组合.<br/><br/>
上面是一个 main 函数, 可以立马在 IDE 中直接运行这个主类, 能够看到控制台输出<br/><br/>
<pre>  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/
 :: Spring Boot ::        (v1.4.1.RELEASE)
...........................
2016-10-05 23:21:05.260 INFO 88095 --- [ main] s.b.c.e.t.TomcatEmbeddedServletContainer : Tomcat started on port(s): 8080 (http)
2016-10-05 23:21:05.271 INFO 88095 --- [ main] hello.SampleController : Started SampleController in 7.402 seconds (JVM running for 8.102)</pre>
<br/>
访问 <code>http://localhost:8080/</code>, 得到预计的输出<br/><br/>
<pre class="brush:bash">➜ / curl -i http://localhost:8080/
HTTP/1.1 200
X-Application-Context: application
Content-Type: text/plain;charset=UTF-8
Content-Length: 12
Date: Thu, 06 Oct 2016 04:28:14 GMT<br/><br/>
Hello World!</pre>
<br/>
其他几种方式运行<br/><br/>
<ol>
    <li>前面提到过, 用 <code>mvn package</code> 生成一个 jar 包, 然后用 <code>java -jar spring-boot-sample-1.0-SNAPSHOT.jar</code> 一样能启动内嵌的 Tomcat</li>
    <li>使用 <code>spring-boot-maven-plugin</code> 插件, 这是开发中最常见的方法, 可以说是 Spring Boot 的标配. 需要在 <code>pom.xml</code> 中添加<br />
<pre class="lang:default decode:true ">&lt;build&gt;
    &lt;plugins&gt;
        &lt;plugin&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
        &lt;/plugin&gt;
    &lt;/plugins&gt;
&lt;/build&gt;</pre>
<br/>
之后便可以用 <code>mvn spring-boot:run</code> 来启动内嵌 Tomcat; 如果需要 Debug 方式启动 Tomcat, <br />
  <code>mvn spring-boot:run -Drun.jvmArguments="-Xdebug -Xrunjdwp:transport=dt_socket,server=y,suspend=y,address=5005"</code></li>
    <li>如果就是想要和从前一样生成一个 WAR 包部署到 Tomcat 里去行吗? 当然没问题, 只要在 <code>pom.xml</code> 中加上项目属性 <code>&lt;packaging&gt;war&lt;/packaging&gt;</code>, 这时候再来 <code>mvn package</code> 生成的就是一个 WAR 包了.</li>
</ol>
<br/>
上面我们是用 <code>SpringApplication.run(SampleController.class, args)</code> 启动了一个 Controller, 如果是要启动多个 Controller 该如何呢? 写上多个就行啦, 在这里<br/><br/>
<pre class="brush:java"> public static void mains(String[] args) throws Exception {
     SpringApplication.run(new Object[]{SampleController.class, AnotherController.class}, args);
 }</pre>
<br/>
其他一些便利:<br/><br/>
<ol>
    <li>引入依赖 org.springframework.boot:spring-boot-starter-actuator 可以获得开箱即得的运维支持, 如 <code>/beans</code> 看到所有的 bean, <code>/info</code> 基本信息, 甚至 <code>/shutdown</code> 关闭应用. 可以启动控制台看到相关的路径映射.</li>
    <li>约定的强大的外部化属性支持, 如从命令行参数, 系统属性; 约定位置外的 <code>application.properties</code> 或 <code>application.yaml</code> 文件中读取属性, 注入时只需 <code>@Value("${name}")</code></li>
    <li><span style="color: #666666; font-family: monospace;"><span style="background-color: #fafafa;">对 <code>/static</code>, <code>/public</code>, <code>/resources</code> 或 <code>/META-INF/resources</code> 目录只默认为静态文件</span></span></li>
    <li>还出了 Spring Boot CLI, 在 Mac 下用  <code>bew tap pivotal/tap; brew install springboot</code> 安装, 命令为 <code>spring</code></li>
</ol>
<br/>
链接:<br/><br/>
<ol>
    <li><a href="https://www.ibm.com/developerworks/cn/java/j-lo-spring-boot/">使用 Spring Boot 快速构建 Spring 框架应用</a></li>
</ol>
<br/>
&nbsp;
