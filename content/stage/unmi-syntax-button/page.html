---
title: 语法加亮插件 SyntaxHighlighter 的好伴侣，轻便的 TinyMCE 工具按钮
url: /unmi-syntax-button/
date: 2010-12-12T11:26:22-06:00
featured: false
draft: true
toc: false
# menu: main
usePageBundles: true
categories:
  - WordPress
  - Web/JS
tags: 
  - plugin
  - Highlighter
  - Syntax
comment: true
codeMaxLines: 50
# additional
wpPostId: 2946 
wpStatus: publish
views: 1629
lastmod: 2013-12-31T23:44:29-06:00
---

用 SyntaxHighlighter 有一段时间了，版本从 1.x、2.x，到现在的最新版本是 3.0.83，1.x 和 2.x 相差较大，2.x 到 3.x 未感觉多大的变化。SyntaxHighlighter 原来是在 google 中的项目，<a href="http://code.google.com/p/syntaxhighlighter/">http://code.google.com/p/syntaxhighlighter/</a>，现在由 <a href="http://www.dbnetsuite.com/shared/track.aspx?code=SH" target="_blank">DbNetLink</a> 赞助，项目移至：<a href="http://alexgorbatchev.com/SyntaxHighlighter/">http://alexgorbatchev.com/SyntaxHighlighter/</a>。<br/>
<br/>
在 WordPress 中关于应用 SyntaxHighlighter 进行语法加亮有众多的插件支持，搜索 <a href="http://wordpress.org/extend/plugins/search.php?q=syntaxhighlighter" target="_blank">SyntaxHighlighter</a> 就知道了。但是为 TinyMCE 辅助的工具按钮却未找到一个较好用的，之前也有介绍过：<a href="http://unmi.cc/tinymce-syntax-highlighter" target="_blank">给 TinyMCE 添加一个语法加亮插件的工具按钮</a>，也是根据某个插件进行修改的。不如之处就是点击按钮后还需与服务端作一次交互，这对于使用国外较慢的空间有些受不了。<!--more--><br/>
<br/>
这里对该插件进一步改进，直接在客户端选择语言生成 &lt;pre class="brush:java"&gt;Java CodeHere&lt;/pre&gt; 这样的代码，并且编辑时已给 &lt;pre&gt; 应用了样式，无需去改动主题的 style.css 文件。<br/>
<br/>
本插件基于 <a href="http://www.viper007bond.com/wordpress-plugins/syntaxhighlighter/" target="_blank">SyntaxHighlighter Evolved</a>，当然你也可以安装其他的以 SyntaxHighlighter 为内核的语法加亮插件。它所带的 SyntaxHighlighter 是目前最新的 3.0.83，按钮下拉显示了 3.0.83 支持的所有语法选择，分了两组，常用的像 java/php 等，其他的像 scala/powershell 等。<br/>
<br/>
如果你不想在下拉菜单中看到那么多的选项的话，你可以编辑插件目录中的 editor_plugin.js 文件中的 common_brushes 和 other_brushes 这两个变量，因为确实多数是用不着的。<br/>
<br/>
<img src="http://unmi.cc/wp-content/uploads/2010/12/syntax-button-1.jpg" alt="" width="750" /><br/>
<br/>
在 TinyMCE 编辑器中添加了一个按钮，点击按钮直接选择语言，然后在编辑区域生成了 &lt;pre class="brush:<strong><span style="color: #ff0000;">所选语言</span></strong>"&gt;<span style="color: #ff0000;"><strong>所选语言</strong></span> CodeHere&lt;/pre&gt;，你只要在其中贴上要被加亮的代码，替换掉 <strong><span style="color: #ff0000;">所选语言</span></strong> CodeHere 即可。注意啦，在编辑器中 &lt;pre&gt; 区域很容易识别出来，因为给它应用了样式：<br/>
<pre class="brush:css">#tinymce pre {<br/>
    font: 12px/18px Consolas, Monaco, "Courier New", Courier, monospace;<br/>
<br/>
    /** Following lines are added by Unmi **/<br/>
    color: #800080;<br/>
    font-style:italic;<br/>
    border-color : #88A9FF;<br/>
    border-width : 1px;<br/>
    border-style : dotted;<br/>
}</pre>

Code 下拉菜单中包括了插件 <a href="http://www.viper007bond.com/wordpress-plugins/syntaxhighlighter/" target="_blank">SyntaxHighlighter Evolved</a> 当前版本中所带有所以支持的语法，它同时兼容了 SyntaxHighlighter 2.x 和 SyntaxHighlighter 3.x，其中的 sass/scss 和 applescript 只在 SyntaxHighlighter 3.x 中支持，还有 latex/tex、f-sharp/fsharp、clojure/Clojure/clj、r/s/splus、objc/obj-c、matlabkey/matlab 是该插件加入的第三方语法高亮脚本，其他的就是 2.x 和 3.x 同时支持的。<br/>
<br/>
插件下载：<a href="http://unmi.cc/downloads/syntax-button-0.2.zip">syntax-button-0.2.zip</a>，建议安装 <a href="http://www.viper007bond.com/wordpress-plugins/syntaxhighlighter/" target="_blank">SyntaxHighlighter Evolved</a> 插件，其他的以 SyntaxHighlighter 为核心的插件未测试过。<br/>
<br/>
当前不足与需加添加的功能有：<br/>
<br/>
1. 增加后台的可配置功能，比如要显示在下拉菜单中的语法选择项可配置，是生成 &lt;pre&gt; 还是 [code][/code][/code]<br/>
<br/>
也要可配置，还可适当支持更多的 SyntaxHighlighter 的选项。<br/>
2. TinyMCE 本身的劣性可在此插件中进行改进，例如 Tab 会被替换成一个空格，多个空格也是被替换成一个空格。<br/>
<br/>
参考：1. <a href="http://www.zzbaike.com/wiki/WordPress%E8%87%AA%E5%AE%9A%E4%B9%89TinyMCE%E6%8C%89%E9%92%AE" target="_blank">WordPress自定义TinyMCE按钮</a><br/>
             2. <a href="http://tinymce.moxiecode.com/examples/example_18.php" target="_blank">Menu button example</a>
