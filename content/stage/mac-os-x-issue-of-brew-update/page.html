---
title: Mac OS X 下不能 brew update 的问题
url: /mac-os-x-issue-of-brew-update/
date: 2015-12-01T11:47:11-06:00
featured: false
draft: true
toc: false
# menu: main
usePageBundles: true
categories:
  - Linux/Unix
tags: 
  - Mac OS
comment: true
codeMaxLines: 50
# additional
wpPostId: 7082 
wpStatus: publish
views: 690
lastmod: 2016-05-07T03:03:24-05:00
---

<p>我在 Mac OS X 下执行 brew update 出错</p><p><span style="color: #800000;">➜   brew update</span><br /><span style="color: #800000;">error: Your local changes to the following files would be overwritten by merge:</span><br /><span style="color: #800000;">    Library/Formula/abcde.rb</span><br /><span style="color: #800000;">    Library/Formula/acpica.rb</span><br /><span style="color: #800000;">    ............</span><br /><span style="color: #800000;">    Library/Formula/pypy.rb</span><br /><span style="color: #800000;">    Library/For</span><br /><span style="color: #800000;">error: The following untracked working tree files would be overwritten by merge:</span><br /><span style="color: #800000;">    Library/Aliases/actor-framework</span><br /><span style="color: #800000;">    Library/Formula/aescrypt-packetizer.rb</span><br /><span style="color: #800000;">    ............</span><br /><span style="color: #800000;">    Library/Formula/stlink.rb</span><br /><span style="color: #800000;">    Library/Formula/with-readline.rb</span><br /><span style="color: #800000;">Please move or remove them before you can merge.</span><br /><span style="color: #800000;">Aborting</span><br /><span style="color: #800000;">Error: Failure while executing: git pull -q origin refs/heads/master:refs/remotes/origin/master</span><!--more--></p><p>找到一个解决办法</p><blockquote><p>cd `brew --prefix`     #fish 下用 cd (brew --prefix)，一般就是 /usr/local 目录<br />git remote add origin https://github.com/mxcl/homebrew.git     #可能已经有这个了<br />git fetch origin<br /><span style="color: #ff0000;">git reset --hard origin/master<span style="color: #000000;">   #这个才是关键</span></span><br />git clean -df</p></blockquote><p>然后再执行 brew update, 可能会说</p><p><span style="color: #800000;">Even if this directory was writable when you installed Homebrew, other</span><br /><span style="color: #800000;">software may change permissions on this directory. Some versions of the</span><br /><span style="color: #800000;">"InstantOn" component of Airfoil are known to do this.</span><br /><br /><span style="color: #800000;">You should probably change the ownership and permissions of /usr/local</span><br /><span style="color: #800000;">back to your user account.</span><br /><span style="color: #800000;">  sudo chown -R $(whoami):admin /usr/local</span></p><p>那就改目录权限吧，fish 下用 sudo chown -R (whoami):admin /usr/local。或者 sudo brew update，改目录权限以后会省事些。</p><p>再做 brew update 成功，运行下 brew upgrade 发现好多软件要更新。</p><p>参考：1. <a href="https://github.com/Homebrew/homebrew/issues/11448" target="_blank">Cannot "brew update" anymore - fails to git pull formulas #11448</a></p><p>&nbsp;</p><hr /><p>后来一次碰到执行 <code>brew install docker</code>  也就是 <code>brew update</code> 报了也是关于 ruby 的错误</p><blockquote><p>/ brew update<br />/System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/lib/ruby/2.0.0/rubygems/core_ext/kernel_require.rb:55:in `require': cannot load such file -- mach (LoadError)<br /> from /System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/lib/ruby/2.0.0/rubygems/core_ext/kernel_require.rb:55:in `require'<br /> from /usr/local/Library/Homebrew/extend/pathname.rb:2:in `&lt;top (required)&gt;'<br /> from /System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/lib/ruby/2.0.0/rubygems/core_ext/kernel_require.rb:55:in `require'<br /> from /System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/lib/ruby/2.0.0/rubygems/core_ext/kernel_require.rb:55:in `require'<br /> from /usr/local/Library/Homebrew/global.rb:3:in `&lt;top (required)&gt;'<br /> from /System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/lib/ruby/2.0.0/rubygems/core_ext/kernel_require.rb:55:in `require'<br /> from /System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/lib/ruby/2.0.0/rubygems/core_ext/kernel_require.rb:55:in `require'<br /> from /usr/local/Library/brew.rb:16:in `&lt;main&gt;'</p></blockquote><p>解决办法是一样一样的。</p>
