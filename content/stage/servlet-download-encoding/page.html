---
title: 请教一下 Servlet 中如何设定下载文件保存用的字符集
url: /servlet-download-encoding/
date: 2009-06-18T03:33:00-05:00
featured: false
draft: true
toc: false
# menu: main
usePageBundles: true
categories:
  - Java/JEE
tags: 
  - Java
  - Servlet
  - encoding
comment: true
codeMaxLines: 50
# additional
wpPostId: 259 
wpStatus: publish
views: 503
lastmod: 2015-07-01T01:54:59-05:00
---

<p>在前面一篇日志：<a href="http://unmi.cc/understand-apply-struts2-file-download/" target="_blank">理解和灵活应用 Struts2 的文件下载功能</a> 还留下一个问题，在 Servlet 中支持文件下载功能时，客户保存下载文件所用的字符集总是 ANSI(ISO8859-1)，如何能设定客户保存文件用的字符集呢？像 BlogJava 的备份数据功能下载后就是用的 UTF-8 字符集的。自己作了一些尝试，总是无济于事，看如下代码是 Servlet 的 doGet() 方法：</p><pre class="brush:java">public void doGet(HttpServletRequest request, HttpServletResponse response)<br/>
		throws ServletException, IOException {<br/>
<br/>
	// PrintWriter out = response.getWriter();<br/>
	PrintWriter out = new PrintWriter(new OutputStreamWriter(response<br/>
			.getOutputStream(), "UTF-8"));<br/>
<br/>
	response.setContentType("text/plain;charset=UTF-8");<br/>
	response.setHeader("Content-Disposition","attachment;filename=down.txt");<br/>
	out.write("Servlet download file test");<br/>
	out.close();<br/>
}</pre><p><!--more-->访问这个 Servlet 时会提示下载文件 down.txt，保存之后用记事本打开，另存它时看到的是 ANSI 编码，或用 EditPlus 打开右下角显示的是 ANSI。然而要是把上面的 "attachment" 改为 "inline"，内容为在线打开，同时右键里看到的却是地地道道的 UTF-8，保存文件却不行。不知道这里各位达人们有无这方面的经验、或是高见，能让下载文件以 UTF-8 编码保存，还望不吝赐教。</p><div id="xunlei_com_thunder_helper_plugin_d462f475-c18e-46be-bd10-327458d045bd"> </div>
