---
title: 使用 SiteMesh2 时为每个页面指定不同的 body id 值
url: /sitemesh2-different-body-id/
date: 2010-10-13T12:29:00-05:00
featured: false
draft: true
type: post
toc: false
# menu: main
usePageBundles: true
categories:
  - Java/JEE
tags: 
  - SiteMesh
comment: true
codeMaxLines: 50
# additional
wpPostId: 2724 
wpStatus: publish
views: 1510
lastmod: 2021-09-03T11:52:19-05:00
---

SiteMesh 是一个很好的 Java Web 模板框架，它的思维方式与通常的模板实现(比如 Tiles 或 include)有些区别。SiteMesh 模板一旦配置好后，在编辑内容页时可以忽视它的存在。可以它是被动，内容页中的输出被<strong>抽取</strong>到模板中，一般的模板为主动的把自己某部分内容去<strong>填充</strong>模板。</p>
<br/>
在站点中应用样式或 JS 代码时很可能会依赖于每个页面的 &lt;body&gt; 的 id，比如：<br/><br/>
body#archive primary{....} /** 样式 **/<br />
$("body#archive").bgColor='red'; //JS<img title="More..." src="http://unmi.cc/wp-includes/js/tinymce/plugins/wordpress/img/trans.gif" alt="" width="1" height="1" /><br/><br/>
所以就要求每个页面有不同的 body id 值。在很多 SiteMesh 的例子中页面渲染后 body 都没有 id 值的，或是相同的 id 值。<img title="More..." src="http://unmi.cc/wp-includes/js/tinymce/plugins/wordpress/img/trans.gif" alt="" width="1" height="1" /><br />
<!--more--><br/><br/>
其实原本是想用 SiteMesh 3 的，当前仍为 Alpha 版，SiteMesh 3 比 SiteMesh 2 要更简单，装饰文件可以不是 jsp，但是要为每个页面设置不同的 body.id 时死活都没成功，它怎么都不认可 &lt;body &lt;sitemesh:write property='body.id'/&gt;&gt; 这样的写法。所以不得再到 SiteMesh 2 里去寻求解决办法，也难怪，本来 Alpha 就是个内测版，极不成熟的。<br/><br/>
SiteMesh 2 的最新版本是 2.4.1，2009-3-15 出品的，项目主页在：<a href="http://www.opensymphony.com/sitemesh">http://www.opensymphony.com/sitemesh</a>。<br />
SiteMesh 3 的最新版本是 3.0 Alpha 1，更新日期为 2009-9-6 日，<a href="http://www.sitemesh.org">http://www.sitemesh.org</a>，目前被墙中。<br/><br/>
那就来看在 SiteMesh 2 中怎么为每个页面指定不同的 body.id 值，有两种办法，都是在模板文件中配置，假如 decorators.xml 文件中的配置如下：<br/><br/>
<pre class="lang:default decode:true">&lt;?xml version="1.0" encoding="utf-8"?&gt;<br/><br/>
&lt;decorators defaultdir="/decorators"&gt;
    &lt;decorator name="main" page="main.jsp"&gt;
        &lt;pattern&gt;/*&lt;/pattern&gt;
    &lt;/decorator&gt;
&lt;/decorators&gt;</pre>
<br/>
那么在写 /decorators/main.jsp 文件的 &lt;body&gt; 标签时可有两种写法：<br/><br/>
1. 直观的取被渲染页的 body.id 值赋给 id 属性:<br/><br/>
&lt;body id="&lt;decorator:getProperty property='body.id'/&gt;"&gt;<br/><br/>
2. 把被渲染页 body 的 id 属性及值一起搬过来：<br/><br/>
&lt;body&lt;decorator:getProperty property="body.id" writeEntireProperty="true" /&gt;&gt;<br/><br/>
用了 writeEntireProperty 属性，会把被渲染页的属性名及其值一起搬过来，并且在属性之前会加个空格。<br/><br/>
现在在内容页(前面称作被渲染页中) 的 &lt;body&gt; 标签就应该加上自己的 id 值了，被渲染后，这个 body.id 被搬到装饰页中 &lt;body&gt; 标签中，也就是当前页面的 body.id 了。<br/><br/>
比如，被渲染的 index.jsp 页面中的 &lt;body&gt; 写作：&lt;body id="body-id-of-index-jsp"&gt;，执行之后看到的页面的 body.id 就是 body-id-of-index-jsp 了。<br/><br/>
来看个图：<br/><br/>
<img src="/wp-content/uploads/2010/10/sitemesh2-bodyid.jpg" alt="SiteMesh2" width="740" height="435" /><br/><br/>
可下载该示例的完整可直接运行的程序 war 包：<a href="/wp-content/uploads/2010/10/test-sitemesh2.war">test-sitemesh2.war</a>。<br/><br/>
参考资料：1. <a href="http://pratinas.net/wiki/SiteMesh">http://pratinas.net/wiki/SiteMesh</a><br />
            2. <a href="http://www.opensymphony.com/sitemesh/tags.html" target="_blank" rel="noopener">SiteMesh - SiteMesh Tag Reference</a>
