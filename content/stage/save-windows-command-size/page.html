---
title: 如何设置 Windows 默认命令行窗口大小和缓冲区大小
url: /save-windows-command-size/
date: 2012-12-20T04:03:03-06:00
featured: false
draft: true
type: post
toc: false
# menu: main
usePageBundles: true
categories:
  - Windows
tags: 
  - Windows
  - cmd
comment: true
codeMaxLines: 50
# additional
wpPostId: 5302 
wpStatus: publish
views: 8034
lastmod: 2012-12-20T04:08:23-06:00
---

Windows 命令行 cmd 窗口系统默认的大小(80*40)对于现在的屏幕配置已经跟不上时代了，我们总是要把它改大些，而且缓冲区大小也想改得大大的。单纯的为当前的 Windows 命令行窗口修改显示大小和缓冲区大小就简单了，右键命令行窗口标题，属性里改屏幕缓冲区和窗口大小就是，系统会为与当前标题相同的命令行窗口记住你的设置，比如 <span style="color: #800000;">C:\Windows\system32\cmd.exe</span>。但是经常你又会打开不同标题的命令行窗口，如 Tomat，这时候它又是默认的 80*40 的窗口大小，又得改，再碰不同标题又要改。<br/>
<br/>
于是能否直接修改系统默认的 cmd 窗口和它的缓冲区大小呢，以后碰到新的标题就参考于它。行的，方法是改注册表。<br/>
<br/>
先来看下你可以在命令行下直接指定命令行窗口的大小了，进到命令行执行 <span style="color: #800000;">mode</span>，可以看到关于控制台的信息如下：<br/>
<br/>
<span style="color: #800000;">Status for device CON:</span><br/>
<span style="color: #800000;"> ----------------------</span><br/>
<span style="color: #800000;"> &nbsp;&nbsp;&nbsp; Lines:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2000</span><br/>
<span style="color: #800000;"> &nbsp;&nbsp;&nbsp; Columns:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 120<!--more--></span><br/>
<span style="color: #800000;"> &nbsp;&nbsp;&nbsp; Keyboard rate:&nbsp; 31</span><br/>
<span style="color: #800000;"> &nbsp;&nbsp;&nbsp; Keyboard delay: 1</span><br/>
<span style="color: #800000;"> &nbsp;&nbsp;&nbsp; Code page:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 936</span><br/>
<br/>
这是我的默认的控制台的大小是 2000 * 120，查看<span style="color: #800000;"> mode</span> 命令的使用，用 mode /? 关于显示模式的修改提示是：<br/>
<br/>
<span style="color: #800000;">Display mode:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MODE CON[:] [COLS=c] [LINES=n]</span><br/>
<br/>
于是可以用命令<span style="color: #800000;"> mode con cols=120 lines=40</span>&nbsp;&nbsp;&nbsp; 或 <span style="color: #800000;">mode 120,40</span> 来修改窗口大小为 120*40,<br/>
<br/>
窗口大小是被改成了你想要的 120*40, 可是悲催的是屏幕缓冲区的大小也变成了 120*40，这让你无法追溯屏幕打印的历史，也就是说 mode 对于窗口大小和屏幕缓冲区大小不能单独设置。<br/>
<br/>
如果启动 cmd.exe 时同时指定窗口大小为 120*40，可以用参数 /k，完整命令是：<br/>
<br/>
<span style="color: #800000;">cmd /k "mode con:cols=120 lines=40"&nbsp;&nbsp; 或 cmd /k "mode 120,40"</span><br/>
<br/>
终极的办法就是修改注册表，先要知道保存系统默认的 cmd 命令窗口的屏幕缓冲区大小的两个键值分别是：<br/>
<br/>
窗口大小：&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #800000;">HKEY_CURRENT_USER\Console\ScreenBufferSize</span>&nbsp;&nbsp;&nbsp;&nbsp; 如果120*40 时值为 002a0078<br/>
屏幕缓冲区大小：&nbsp; <span style="color: #800000;">HKEY_CURRENT_USER\Console\WindowSize</span>&nbsp;&nbsp;&nbsp;&nbsp; 如 120*2000 时值为 07d00078<br/>
<br/>
这是用的十六进制值来表示的，十六进制可以前加零来补齐为 8 位来理解.十六进制的前四位是高，后四位是宽，如：<br/>
<br/>
<span style="color: #800000;">002a0078&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0078 的十进制是 120, 002a 的十进制是 40，窗口大小是 120*40</span><br/>
<br/>
<span style="color: #800000;">07d00078&nbsp;&nbsp;&nbsp; 00078 的十进制是 120, 07d0 的十进制是 2000, 缓冲区大小就是&nbsp; 120*2000</span><br/>
<br/>
因为涉及到十六进制截断成两部分，所以你想直接转换成十进制数来设置就意义不大了，比如 002a0078 的十进制数是 2752632，谁知道这个数与 120*40 有什么关系呢！<br/>
<br/>
如果觉得这样对应起来算起来麻烦，那就想办法从别处 copy 吧，对于直接命令 cmd 进入的窗口设置好你的窗口大小和屏幕缓冲区大小，注册表里会帮你在 <span style="color: #800000;">HKEY_CURRENT_USER\Console\%SystemRoot%_system32_cmd.exe</span> 下创建有你的两个键值 <span style="color: #800000;">WindowSize</span> 和&nbsp; <span style="color: #800000;">ScreenBufferSize</span>，把这两值分别应用给<br/>
<br/>
<span style="color: #800000;"> HKEY_CURRENT_USER\Console\WindowSize</span><br/>
<span style="color: #800000;">HKEY_CURRENT_USER\Console\ScreenBufferSize</span><br/>
<br/>
就行啦，下次只要是进到命令行窗口时，默认就会应用这个大小。<br/>
<br/>
知道个中原理，你想用什么工具来修改注册表的那两值就随你啦，可以是导出的 reg 文件，或是用下面两条命令来把窗口大小和屏幕缓冲区大小分别改成 120*40 和&nbsp; 120*2000:<br/>
<pre class="brush:bash">reg add "HKEY_CURRENT_USER\Console" /t REG_DWORD /v WindowSize /d 0x002a0078 /f<br/>
reg add "HKEY_CURRENT_USER\Console" /t REG_DWORD /v ScreenBufferSize /d 0x07d00078 /f</pre>

在 1280*1024 的屏幕分辨率下我比较喜欢设置的命令行窗口大小和屏幕缓冲区大小分别是： 130*42&nbsp; 和 130*2000，相应的命令就是：<br/>
<pre class="brush:bash">reg add "HKEY_CURRENT_USER\Console" /t REG_DWORD /v WindowSize /d 0x002a0082 /f<br/>
reg add "HKEY_CURRENT_USER\Console" /t REG_DWORD /v ScreenBufferSize /d 07d00082 /f</pre>

我喜欢用 cmd 窗口的快速编辑模式，顺便也把它打开，用命令：<br/>
<pre class="brush:bash">reg add "HKEY_CURRENT_USER\Console" /t REG_DWORD /v QuickEdit /d 0x0000001 /f</pre>

以后记下前面三条 reg 命令就 OK 啦，没什么特殊的要求可以不用为某些标题对应的窗口单独设置这些属性了。比如你不需要为&nbsp;<span style="color: #800000;">C:\Windows\system32\cmd.exe</span> 单独设置窗口的属性就把注册表的键 <span style="color: #800000;">HKEY_CURRENT_USER\Console\%SystemRoot%_system32_cmd.exe</span> 删除了事。
