---
title: Backbone.js 的 View 中定义事件
url: /backbone-view-define-events/
date: 2014-01-06T00:48:45-06:00
featured: false
thumbnail: "../images/logos/backbonejs-logo.png"
draft: false
type: post
toc: false
# menu: main
usePageBundles: true
categories:
  - Web/JS
tags: 
  - javascript
  - Backbone
comment: true
codeMaxLines: 50
# additional
wpPostId: 6011 
wpStatus: publish
views: 4918
lastmod: 2021-05-05T15:50:49-05:00
---

使用 Backbone 的 View 时，可以象传统 jQuery 那样定义事件，<code>$("selector").click(function(){...})</code>。幸运的是 Backbone 让我们在 View 中定义事件变得更为简单和集中，只要设置 View 的 <code>events</code> 属性，配置 事件，元素以及相应的处理方法，基本模式如下：</p>

{{< highlight js >}}
events: {
    "click button": "event_handler",
    "focus #name": "event_handler"
},

event_handler: function( event ) {
    alert(event.target.id);
}
{{</ highlight >}}

格式是 <code>"事件 选择器": "事件处理函数名"</code>, 奇怪为什么这里不是使用事件处理函数名的引用，也就是<strong>不能</strong>写成下面两种方式：<!--more--><br/>
{{< highlight js >}}
"click button": event_handler
或者 "click button": function(event){ ..... }
{{</ highlight >}}
<br/>
也就不能更好的进行语法检查和一气呵成的写上面的事件代码。<br/><br/>
还是上完整的演示代码<br/>
{{< highlight html >}}
<!DOCTYPE html>
<html>
     <head>
         <script src="http://ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
         <script src="http://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.5.2/underscore-min.js"></script>
         <script src="http://cdnjs.cloudflare.com/ajax/libs/backbone.js/1.0.0/backbone-min.js"></script>
     </head>
     <body>
        <div id="container"></div>
        <br/>Button not from Backbone: <button id="btn3">Button2</button>
        <script type="text/template" id="my_template">
            <input id="name">
            <button id="btn1">Button1</button>
        </script>
     </body>
 </html>
 
 <script>
    var AppView = Backbone.View.extend({
        el: '#container',
        initialize: function(options) {
            this.render();
        },
        render: function() {
            var template = _.template($("#my_template").html());
            this.$el.html(template);
        },
        events: {
            "click button": "event_handler",
            "blur #name": "event_handler"
        },
        event_handler: function( event ){
            alert(event.target.id);
        }
    });

    var appView = new AppView();
</script>
{{</ highlight >}}
<br/>
点击 <a href="http://fiddle.jshell.net/Unmi/2Dcy4/" target="_blank" rel="noopener">http://fiddle.jshell.net/Unmi/2Dcy4/</a> 运行上面的代码，会发现在输入框失去焦点和点击 Button1 时都会触发事件的执行，但是点击 Button2 是不会触发 <code>event_handler</code> 事件处理方法的。也就是说上面绑定事件采用了如下代码：<br/>
{{< highlight js >}}
this.$el.find("button").click(event_handler);
{{</ highlight >}}
<br/>
<code>"click button"</code> 这句只会在 <code>this.$el</code> 范围内应用选择器查找元素来绑定事件。<br/><br/>
参考： 1. <a href="http://backbonetutorials.com/what-is-a-view/" target="_blank" rel="noopener">What is a view?</a><br />
        2. <a href="http://www.codebeerstartups.com/2012/12/12-listening-to-dom-events-in-backbone-js-learning-backbone-js/" target="_blank" rel="noopener">java12 Listening to DOM events in backbone js – Learning Backbone js</a>
