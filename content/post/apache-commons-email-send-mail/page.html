---
title: 用 apache commons-email 轻松发送无乱码邮件
url: /apache-commons-email-send-mail/
date: 2006-12-06T23:48:00-06:00
featured: false
draft: false
type: post
toc: false
# menu: main
usePageBundles: true
thumbnail: "../images/logos/java-logo.png"
categories:
  - Java/JEE
tags: 
  - Apache
  - email
comment: true
codeMaxLines: 50
# additional
wpPostId: 537 
wpStatus: publish
views: 1485
lastmod: 2019-11-10T15:55:00-06:00
---

原来项目中都是自己拿到 mail.jar 和 activation.jar 两个包编写发送Email的代码，虽然不难，但也有些麻烦。</p>
<br/>
现在好了，在 apache 站点有一个 jarkata/commons/email 子项目，也为我们实现了发送 Email 的功能，在 <a href="http://jakarta.apache.org/commons/email/">http://jakarta.apache.org/commons/email/</a> 把包 commons-email-1.0.jar 下来，自己要写的代码就十分少了，并且非常明了。<br/><br/>
这个包的大小只有23K，也就是9个类而已，却能让您省不少事。<!--more--><br/><br/>
commons-email 提供了 SimpleEmail、MultiPartEmail、HtmlEmail、EmailAttachment 等类，只需要您按正常思维简单的写几行代码就能发各种类型的 Email，一般我们用 JavaMail 发送 Email 会碰到中文乱码问题，主要是出现在把代码放在英文系统中执行时，处理方法是主题和内容使用 GBK 或 UTF-8 字符集。<br/><br/>
在 <a href="http://jakarta.apache.org/commons/email/userguide.html">http://jakarta.apache.org/commons/email/userguide.html</a> 有 commons-email 的使用示例，如果直接用第一个例子放在英文环境中发送带中文主题或内容的邮件也会出现乱码，<br/><br/>
这里对第一个例子稍做改造，可以让发出的 Email 中文不出现乱码，如下：<br/>
{{< highlight java >}}
package com.unmi;  

import org.apache.commons.mail.SimpleEmail;  

public class MailTo  
{  
    /** 
     * @Author Unmi  
     * @param args  
     * @throws Exception   
     */ 
    public static void main(String[] args) throws Exception  
    {  
        //发送简单邮件  
        SimpleEmail email = new SimpleEmail();  

        email.setHostName("mail.2911.net");  

        //需要邮件发送服务器验证,用户名/密码  
        email.setAuthentication("broodwar", "xxxxxx");  
        email.addTo("<a href="mailto:fantasia@sina.com">fantasia@sina.com</a>", "fantasia");  
        email.setFrom("<a href="mailto:broodwar@2911.net">broodwar@2911.net</a>", "Broodwar");  

        //设置主题的字符集为UTF-8  
        email.setCharset("UTF-8");   
        email.setSubject("测试邮件主题");  

        email.buildMimeMessage();  

        //设置内容的字符集为UTF-8,先buildMimeMessage才能设置内容文本  
        email.getMimeMessage().setText("测试邮件内容","UTF-8");  
        email.sendMimeMessage();  
    }  
} 
{{</ highlight >}}
<br/>
以后在 Java 中发邮件就用这个 commons-email 组件就好了，如果要发送 HTML 邮件或者带附件的邮件就学着 <a href="http://jakarta.apache.org/commons/email/userguide.html">http://jakarta.apache.org/commons/email/userguide.html</a> 中的例子做即可，出现中文乱码，跟到源代码中想想办法自己动动脑。
