---
title: 解决 Eclipse 中 Android.jar 无法关联源代码的办法
url: /eclipse-android-jar-attach-source-code/
date: 2011-03-20T04:09:28-05:00
featured: false
draft: false
type: post
toc: false
# menu: main
usePageBundles: true
thumbnail: "../images/logos/java-android.gif"
categories:
  - Android
tags: 
  - android
comment: true
codeMaxLines: 50
# additional
wpPostId: 3341 
wpStatus: publish
views: 5830
lastmod: 2014-01-05T00:10:59-06:00
---

在 Eclipse 中一般的 jar 包在(F3 或 Ctrl + Click) 进到它的 Class 时，如果没有关联上源代码会有一个按钮让你关联下就可以查看源代码。可是在 Eclipse 中的 android.jar 中的类，却只会提示<br/>
<br/>
Source not found<br/>
The JAR of this class file belongs to container 'Android 1.6' which does not allow modifications to source attachments on its entries.<br/>
<br/>
也就是正常渠道关联不上源代码，那使用手动来引入 android.jar，用传统的方式来关联源代码如何，源码是能看到了，可是出现个错误。还是 Google 下吧，找到了 <a href="http://stuffthathappens.com/blog/2008/11/01/browsing-android-source-in-eclipse/" target="_blank">Browsing Android Source in Eclipse</a>，他给我们提供了两种解决办法：<br/>
<br/>
#Solution 1<!--more--><br/>
<br/>
把源代码解压到 android.jar 所在目录的 sources 子目录中，sources 要自己创建，看起来目录层次如下：<br/>
{{< highlight text >}}
SDK_PATH  //在 sdk 1.6 中是在 ../android-sdk-windows-1.6_r1/platforms/android-1.6 目录
  | android.jar
  +--data/...
  +--samples/...
  +--sources
       +--android
       |      ...accounts, annotation, app, bluetooth, etc...
       +--com/android/etc...
       +--dalvik/...
       +--java/...
       +--javax/...
{{</ highlight >}}

完后重启 Eclipse 后，点击了 Android 的 class 后就会显示出它所对应的源程序来：<br/>
<br/>
<img alt="Android attach source" src="http://stuffthathappens.com/blog/wp-content/uploads/2008/11/picture-3.png" width="750" height="404" /><br/>
<br/>
Android sdk 的源代码你可以使用 Git 自己下载，也可从 <a title="包含有从 Android SDK 1.1 到 2.0 版本的源码下载链接，墙内可访问的哦" href="http://www.eoeandroid.com/thread-29101-1-14.html">Android SDK Source Code下载地址</a> 下载别人打好包的源码。<br/>
<br/>
#Solution 2<br/>
<br/>
为你的 Android 项目引入外部 jar 的方式把 android.jar 加到 classpath 中去，那么这个外部的 android.jar 就可以关联上源代码。可是此时项目有两个 android.jar，编译时也只会认一开始那个 android.jar，所以还是关联不上源码。<br/>
{{< bundle-image android_eclipse.jpg >}}

现在把创建 Android 工程带的那个 Android 1.6 移除掉，OK 源代码是能够关联上，可是项目会出现一个 Error:<br/>
<br/>
Description&nbsp;&nbsp;&nbsp; Resource&nbsp;&nbsp;&nbsp; Path&nbsp;&nbsp;&nbsp; Location&nbsp;&nbsp;&nbsp; Type<br/>
Conversion to Dalvik format failed with error 1&nbsp;&nbsp;&nbsp; TestAndroid&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Unknown&nbsp;&nbsp;&nbsp; Android ADT Problem<br/>
<br/>
反正我是照着 <a href="http://stuffthathappens.com/blog/2008/11/01/browsing-android-source-in-eclipse/" target="_blank">Browsing Android Source in Eclipse</a> 第二个方案来做的，项目无法运行，不知道谁有这相应的解决办法。<br/>
<br/>
不管怎么说吧，第一个办法是很好，一劳永逸，不需要每次为项目手工引入 android.jar (假定第二种方案是可行的)。<br/>
<br/>
上面讲述的是对于 ADT-0.9.3 + Android sdk 1.6_r1 的源码关联的解决办法，对应于新版 ADT 和 Android SDK 或许会容易些。<br/>
<br/>
参考：1. <a href="http://stuffthathappens.com/blog/2008/11/01/browsing-android-source-in-eclipse/" target="_blank">Browsing Android Source in Eclipse</a><br/>
2. http://www.cnmsdn.com/html/201103/1300269607ID9694.html<br/>
<br/>
<hr /><br/>
现在用 Eclispe 3.6 + ADT 10 + Android SDK r10 又可以像普通 jar 包那样关联源代码了。
